<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./css/styles.css" />
    <link rel="stylesheet" href="./css/weather.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <title>Weather Forecast</title>
  </head>

  <body>
    <!-- Navigation -->
    <div class="navigation">
      <nav>
        <h3><a id="nav-logo" href="/">Â¿Who Knows?</a></h3>
        <div class="navigation-links">
          <a id="nav-weather" href="/weather">Weather</a>
          <a id="nav-logout" href="/api/logout">Log out</a>
          <a id="nav-register" href="/register">Register</a>
          <a id="nav-login" href="/login">Log in</a>
        </div>
      </nav>
    </div>

    <!-- Weather Section -->
    <div class="weather-container">
      <h1>Weather Forecast</h1>
      <div class="forecast" id="weather-container">
        <p>Loading weather data...</p>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <span>Â¿Who Knows? Â© 2009</span>
      <a href="/about">about</a>
    </footer>

    <script src="js/navbar.js"></script>
    <script>
      async function loadWeather() {
        const container = document.getElementById("weather-container");
        try {
          const res = await fetch("/api/weather");
          if (!res.ok) throw new Error("Failed to fetch weather");
          const data = await res.json();

          container.innerHTML = "";

          data.days.forEach((day) => {
            const div = document.createElement("div");
            div.className = "weather-day";
            div.innerHTML = `
    <span class="date">${day.date}</span>
    <span class="temps">ðŸŒ¡ ${day.tmin}Â°C â€“ ${day.tmax}Â°C</span>
    <span class="code">code ${day.code}</span>
  `;
            container.appendChild(div);
          });

          const footer = document.createElement("div");
          footer.className = "forecast-footer";
          footer.textContent = `Source: ${data.source} â€¢ Updated: ${new Date(
            data.updated
          ).toLocaleString()} (${data.timezone})`;
          container.appendChild(footer);
        } catch (err) {
          container.innerHTML = `<p style="color:red;">Error loading weather data: ${err.message}</p>`;
        }
      }

      document.addEventListener("DOMContentLoaded", loadWeather);
    </script>
  </body>
</html>
